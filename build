#!/bin/bash -e
cd $(dirname $0)

PATH=$HOME/go/bin:$PATH
unset GOPATH

go mod download

./builtintest/clean

./copy-threadsafe-builtins

./get-statics-tool

go generate .

echo
echo Installing...
go install .

type runtemplate

echo
echo Generating tests...
go generate -v ./builtintest/...

rm -rf examples

echo
echo Testing...
go test ./...
#go test $coveralls_testflags $GOBUILDFLAG $@ .

mkdir examples
rsync -a --filter=". .sync.txt" builtintest/* examples
