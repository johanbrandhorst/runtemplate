#!/bin/bash -e
cd $(dirname $0)

PATH=$HOME/go/bin:$PATH
unset GOPATH

go mod download

./builtintest/clean

./copy-threadsafe-builtins

./get-statics-tool

go generate .

echo
echo App Testing...
go test ./app/...

echo
echo Installing...
go install .

type runtemplate

echo
echo Generating tests...
go generate -v ./builtintest/...

rm -f examples/*_*.go
go generate ./examples

gofmt -l -w examples/*.go

echo
echo Template Testing...
go test ./...
#go test $coveralls_testflags $GOBUILDFLAG $@ .
